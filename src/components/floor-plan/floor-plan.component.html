<div class="bg-white p-6 rounded-xl shadow-sm h-full flex flex-col">
  <h3 class="text-lg font-semibold text-slate-800 mb-1">Plano de la Residencia</h3>
  <p class="text-sm text-slate-500 mb-4">Ubicación del residente en tiempo real.</p>

  <div class="flex-grow grid grid-cols-2 grid-rows-3 gap-2 bg-slate-50 rounded-lg p-2 relative h-64">
    <!-- Patient marker -->
    <div class="absolute flex items-center justify-center z-10 p-1 transition-all duration-1000 ease-in-out"
         [style.grid-row]="markerPosition().row"
         [style.grid-column]="markerPosition().col">
        <div class="relative flex items-center justify-center">
            <span class="absolute inline-flex h-full w-full rounded-full bg-sky-400 opacity-75 animate-ping"></span>
            <img [src]="patientAvatarUrl()" alt="Avatar del paciente" class="relative w-12 h-12 rounded-full border-2 border-white shadow-lg">
        </div>
    </div>

    <!-- Rooms -->
    <div class="bg-sky-100 rounded-md flex flex-col items-center justify-center text-sky-800 font-semibold text-sm transition-all duration-300"
         [class.ring-2]="currentRoom() === 'Dormitorio'"
         [class.ring-sky-500]="currentRoom() === 'Dormitorio'"
         [class.shadow-lg]="currentRoom() === 'Dormitorio'"
         [class.shadow-sky-200/50]="currentRoom() === 'Dormitorio'">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mb-1 opacity-60"><path fill-rule="evenodd" [attr.d]="ICONS.bedroom" clip-rule="evenodd" /></svg>
      Dormitorio
    </div>
    <div class="bg-indigo-100 rounded-md flex flex-col items-center justify-center text-indigo-800 font-semibold text-sm transition-all duration-300"
         [class.ring-2]="currentRoom() === 'Baño'"
         [class.ring-indigo-500]="currentRoom() === 'Baño'"
         [class.shadow-lg]="currentRoom() === 'Baño'"
         [class.shadow-indigo-200/50]="currentRoom() === 'Baño'">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mb-1 opacity-60"><path [attr.d]="ICONS.bathroom" /></svg>
      Baño
    </div>
    <div class="bg-purple-100 rounded-md flex flex-col items-center justify-center text-purple-800 font-semibold text-sm transition-all duration-300"
         [class.ring-2]="currentRoom() === 'Sala de estar'"
         [class.ring-purple-500]="currentRoom() === 'Sala de estar'"
         [class.shadow-lg]="currentRoom() === 'Sala de estar'"
         [class.shadow-purple-200/50]="currentRoom() === 'Sala de estar'">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mb-1 opacity-60"><path [attr.d]="ICONS.livingRoom" /></svg>
      Sala de estar
    </div>
    <div class="bg-yellow-100 rounded-md flex flex-col items-center justify-center text-yellow-800 font-semibold text-sm transition-all duration-300"
         [class.ring-2]="currentRoom() === 'Cocina'"
         [class.ring-yellow-500]="currentRoom() === 'Cocina'"
         [class.shadow-lg]="currentRoom() === 'Cocina'"
         [class.shadow-yellow-200/50]="currentRoom() === 'Cocina'">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mb-1 opacity-60"><path [attr.d]="ICONS.kitchen" /></svg>
      Cocina
    </div>
    <div class="bg-green-100 rounded-md flex flex-col items-center justify-center text-green-800 font-semibold text-sm col-span-2 transition-all duration-300"
         [class.ring-2]="currentRoom() === 'Jardín'"
         [class.ring-green-500]="currentRoom() === 'Jardín'"
         [class.shadow-lg]="currentRoom() === 'Jardín'"
         [class.shadow-green-200/50]="currentRoom() === 'Jardín'">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mb-1 opacity-60"><path [attr.d]="ICONS.garden" /></svg>
      Jardín
    </div>
  </div>
</div>